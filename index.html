<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Anime Higher Lower</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }
      :root {
        --primary: #667eea;
        --secondary: #f5576c;
        --success: #10b981;
        --error: #ef4444;
        --warning: #fbbf24;
        --bg: #0a0e27;
      }
      body {
        font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
        background: var(--bg);
        color: #fff;
        min-height: 100vh;
        overflow-x: hidden;
      }
      .sr-only {
        position: absolute;
        width: 1px;
        height: 1px;
        padding: 0;
        margin: -1px;
        overflow: hidden;
        clip: rect(0, 0, 0, 0);
        white-space: nowrap;
        border: 0;
      }
      .background {
        position: fixed;
        inset: 0;
        z-index: 0;
      }
      .bg-blob {
        position: absolute;
        border-radius: 40% 60% 70% 30%/40% 50% 60% 50%;
        opacity: 0.08;
        will-change: transform;
      }
      @media (prefers-reduced-motion: no-preference) {
        .bg-blob {
          animation: blob 8s infinite;
        }
        .blob-1 {
          animation-duration: 10s;
        }
        .blob-2 {
          animation-duration: 12s;
          animation-delay: -2s;
        }
      }
      .blob-1 {
        width: 400px;
        height: 400px;
        background: linear-gradient(135deg, #667eea, #764ba2);
        top: -100px;
        left: -100px;
      }
      .blob-2 {
        width: 350px;
        height: 350px;
        background: linear-gradient(135deg, #f093fb, #f5576c);
        bottom: -50px;
        right: -50px;
      }
      @keyframes blob {
        0%,
        100% {
          transform: translate(0, 0) rotate(0deg);
        }
        33% {
          transform: translate(30px, -50px) rotate(120deg);
        }
        66% {
          transform: translate(-20px, 20px) rotate(240deg);
        }
      }
      .header {
        position: relative;
        z-index: 10;
        padding: 20px 40px;
        display: flex;
        justify-content: space-between;
        align-items: center;
        backdrop-filter: blur(20px);
        border-bottom: 1px solid rgba(255, 255, 255, 0.08);
        flex-wrap: wrap;
        gap: 20px;
      }
      .logo {
        font-size: 28px;
        font-weight: 900;
        background: linear-gradient(135deg, #667eea, #f5576c);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
        letter-spacing: -1px;
      }
      .header-actions {
        display: flex;
        gap: 15px;
        align-items: center;
      }
      .tutorial-link {
        background: rgba(102, 126, 234, 0.2);
        border: 2px solid rgba(102, 126, 234, 0.3);
        color: #667eea;
        padding: 8px 16px;
        border-radius: 8px;
        cursor: pointer;
        font-size: 13px;
        font-weight: 600;
        text-transform: uppercase;
        letter-spacing: 1px;
        transition: all 0.3s ease;
      }
      .tutorial-link:hover,
      .tutorial-link:focus-visible {
        background: rgba(102, 126, 234, 0.4);
        border-color: rgba(102, 126, 234, 0.6);
        transform: translateY(-2px);
        outline: 3px solid rgba(102, 126, 234, 0.4);
        outline-offset: 2px;
      }
      .score-container {
        display: flex;
        gap: 40px;
        align-items: center;
      }
      .score-item {
        text-align: right;
      }
      .score-label {
        font-size: 11px;
        text-transform: uppercase;
        letter-spacing: 2px;
        color: rgba(255, 255, 255, 0.6);
        margin-bottom: 6px;
        font-weight: 600;
      }
      .score-value {
        font-size: 32px;
        font-weight: 800;
        background: linear-gradient(135deg, #667eea, #f5576c);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
      }
      .streak-badge {
        background: linear-gradient(135deg, #fbbf24, #f59e0b);
        color: #000;
        padding: 4px 12px;
        border-radius: 20px;
        font-size: 11px;
        font-weight: 700;
        text-transform: uppercase;
        letter-spacing: 1px;
        margin-top: 4px;
        opacity: 0;
        transform: scale(0.8);
        transition: all 0.3s ease;
        display: inline-block;
      }
      .streak-badge.visible {
        opacity: 1;
        transform: scale(1);
      }
      .sound-toggle {
        position: fixed;
        bottom: 30px;
        right: 30px;
        z-index: 20;
        background: rgba(102, 126, 234, 0.2);
        border: 2px solid rgba(102, 126, 234, 0.3);
        width: 50px;
        height: 50px;
        border-radius: 50%;
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 24px;
        transition: all 0.3s ease;
      }
      .sound-toggle:hover,
      .sound-toggle:focus-visible {
        background: rgba(102, 126, 234, 0.4);
        border-color: rgba(102, 126, 234, 0.6);
        transform: scale(1.1);
        outline: 3px solid rgba(102, 126, 234, 0.4);
        outline-offset: 2px;
      }
      .tutorial-modal,
      .modal {
        position: fixed;
        inset: 0;
        background: rgba(10, 14, 39, 0.95);
        backdrop-filter: blur(20px);
        display: none;
        align-items: center;
        justify-content: center;
        z-index: 1001;
        opacity: 0;
        transition: opacity 0.3s ease;
      }
      .tutorial-modal.active,
      .modal.active {
        display: flex;
        opacity: 1;
      }
      .tutorial-content,
      .modal-content {
        background: linear-gradient(
          135deg,
          rgba(20, 25, 50, 0.95),
          rgba(30, 35, 65, 0.95)
        );
        border: 2px solid rgba(102, 126, 234, 0.3);
        border-radius: 32px;
        padding: 50px;
        text-align: center;
        max-width: 500px;
        width: 90%;
        backdrop-filter: blur(20px);
        box-shadow: 0 40px 100px rgba(0, 0, 0, 0.6);
        max-height: 90vh;
        overflow-y: auto;
      }
      @media (prefers-reduced-motion: no-preference) {
        .tutorial-content,
        .modal-content {
          animation: modalPop 0.5s cubic-bezier(0.4, 0, 0.2, 1);
        }
      }
      @keyframes modalPop {
        from {
          opacity: 0;
          transform: scale(0.8) translateY(30px);
        }
        to {
          opacity: 1;
          transform: scale(1) translateY(0);
        }
      }
      .tutorial-title,
      .modal-title {
        font-size: 36px;
        font-weight: 900;
        margin-bottom: 16px;
        background: linear-gradient(135deg, #667eea, #f5576c);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
      }
      .modal-title {
        font-size: 42px;
      }
      .tutorial-steps {
        text-align: left;
        margin: 25px 0;
        font-size: 14px;
        line-height: 1.8;
        color: rgba(255, 255, 255, 0.8);
      }
      .tutorial-steps li {
        margin-bottom: 12px;
        list-style: none;
        padding-left: 30px;
        position: relative;
      }
      .tutorial-steps li:before {
        content: "‚Üí";
        position: absolute;
        left: 0;
        color: #667eea;
        font-weight: bold;
      }
      .keyboard-hint {
        background: rgba(102, 126, 234, 0.1);
        border: 1px solid rgba(102, 126, 234, 0.3);
        padding: 12px;
        border-radius: 12px;
        margin-top: 16px;
        font-size: 13px;
        color: rgba(255, 255, 255, 0.9);
      }
      .tutorial-btn,
      .btn-play-again {
        background: linear-gradient(135deg, #667eea, #f5576c);
        color: #fff;
        padding: 14px 40px;
        border: none;
        border-radius: 14px;
        font-size: 15px;
        font-weight: 700;
        cursor: pointer;
        text-transform: uppercase;
        letter-spacing: 1.5px;
        transition: all 0.3s ease;
        margin-top: 20px;
        min-height: 48px;
      }
      .tutorial-btn:hover,
      .tutorial-btn:focus-visible,
      .btn-play-again:hover,
      .btn-play-again:focus-visible {
        transform: translateY(-3px);
        box-shadow: 0 12px 40px rgba(102, 126, 234, 0.5);
        outline: 3px solid rgba(102, 126, 234, 0.4);
        outline-offset: 2px;
      }
      .container {
        position: relative;
        z-index: 5;
        min-height: calc(100vh - 100px);
        display: flex;
        align-items: center;
        justify-content: center;
        padding: 40px 20px;
      }
      .game-area {
        display: grid;
        grid-template-columns: 1fr auto 1fr;
        gap: 60px;
        width: 100%;
        max-width: 1400px;
        align-items: center;
      }
      .character-card {
        position: relative;
        height: 600px;
        border-radius: 32px;
        overflow: hidden;
        backdrop-filter: blur(20px);
        border: 1px solid rgba(255, 255, 255, 0.1);
        transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        will-change: transform;
      }
      @media (prefers-reduced-motion: no-preference) {
        .character-card:hover:not(.disabled) {
          transform: translateY(-12px) translateZ(0);
          border-color: rgba(255, 255, 255, 0.2);
          box-shadow: 0 30px 80px rgba(102, 126, 234, 0.2);
        }
      }
      .card-bg {
        position: absolute;
        inset: 0;
        z-index: 0;
      }
      .card-bg img {
        width: 100%;
        height: 100%;
        object-fit: cover;
        filter: blur(40px) brightness(0.4);
        transform: scale(1.3);
      }
      .card-overlay {
        position: absolute;
        inset: 0;
        background: linear-gradient(
          135deg,
          rgba(102, 126, 234, 0.1) 0%,
          rgba(10, 14, 39, 0.8) 100%
        );
        z-index: 1;
      }
      .card-content {
        position: relative;
        z-index: 2;
        height: 100%;
        display: flex;
        flex-direction: column;
        padding: 40px 30px;
        justify-content: space-between;
      }
      .character-img-wrapper {
        flex: 1;
        display: flex;
        align-items: center;
        justify-content: center;
        margin-bottom: 20px;
      }
      .character-img {
        width: 280px;
        height: 340px;
        border-radius: 24px;
        overflow: hidden;
        border: 2px solid rgba(255, 255, 255, 0.15);
        box-shadow: 0 25px 60px rgba(0, 0, 0, 0.6);
        backdrop-filter: blur(10px);
        transition: all 0.4s ease;
        background: rgba(0, 0, 0, 0.3);
        position: relative;
      }
      .character-img.loading::before {
        content: "";
        position: absolute;
        inset: 0;
        background: linear-gradient(
          90deg,
          transparent,
          rgba(255, 255, 255, 0.1),
          transparent
        );
        animation: shimmer 1.5s infinite;
      }
      @keyframes shimmer {
        0% {
          transform: translateX(-100%);
        }
        100% {
          transform: translateX(100%);
        }
      }
      .character-img img {
        width: 100%;
        height: 100%;
        object-fit: cover;
      }
      .character-info {
        text-align: center;
      }
      .character-name {
        font-size: 26px;
        font-weight: 800;
        margin-bottom: 8px;
        text-shadow: 0 4px 12px rgba(0, 0, 0, 0.8);
      }
      .character-anime {
        font-size: 13px;
        color: rgba(255, 255, 255, 0.7);
        margin-bottom: 20px;
        font-weight: 500;
      }
      .stat-box {
        background: rgba(0, 0, 0, 0.4);
        backdrop-filter: blur(10px);
        border: 1px solid rgba(255, 255, 255, 0.1);
        border-radius: 16px;
        padding: 20px;
        transition: all 0.4s ease;
      }
      .stat-label {
        font-size: 11px;
        color: rgba(255, 255, 255, 0.8);
        text-transform: uppercase;
        letter-spacing: 1.5px;
        font-weight: 600;
        margin-bottom: 8px;
      }
      .stat-number {
        font-size: 35px;
        font-weight: 800;
        color: #fff;
        text-shadow: 0 2px 8px rgba(0, 0, 0, 0.8);
        transition: all 0.3s ease;
      }
      .stat-number.hidden {
        color: rgba(255, 255, 255, 0.3);
        font-size: 48px;
        font-weight: 400;
        letter-spacing: 8px;
      }
      .stat-number.correct {
        color: var(--success);
      }
      .stat-number.incorrect {
        color: var(--error);
      }
      @media (prefers-reduced-motion: no-preference) {
        .stat-number.correct {
          animation: pulse 0.6s ease;
        }
        .stat-number.incorrect {
          animation: shake 0.6s ease;
        }
      }
      @keyframes pulse {
        0%,
        100% {
          transform: scale(1);
        }
        50% {
          transform: scale(1.15);
        }
      }
      @keyframes shake {
        0%,
        100% {
          transform: translateX(0);
        }
        25% {
          transform: translateX(-10px);
        }
        75% {
          transform: translateX(10px);
        }
      }
      .comparison-info {
        font-size: 12px;
        color: rgba(255, 255, 255, 0.7);
        margin-top: 8px;
        opacity: 0;
        transition: opacity 0.3s ease;
      }
      .comparison-info.visible {
        opacity: 1;
      }
      .vs-circle {
        width: 160px;
        height: 160px;
        border-radius: 50%;
        background: rgba(102, 126, 234, 0.1);
        border: 3px solid rgba(102, 126, 234, 0.3);
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 52px;
        font-weight: 900;
        color: #667eea;
        position: relative;
        flex-shrink: 0;
        overflow: hidden;
        transition: all 0.6s cubic-bezier(0.4, 0, 0.2, 1);
        backdrop-filter: blur(10px);
        will-change: transform;
      }
      @media (prefers-reduced-motion: no-preference) {
        .vs-circle {
          animation: float 3s ease-in-out infinite;
        }
      }
      @keyframes float {
        0%,
        100% {
          transform: translateY(0);
        }
        50% {
          transform: translateY(-20px);
        }
      }
      .vs-circle::before {
        content: "";
        position: absolute;
        inset: 0;
        border-radius: 50%;
        background: none;
        transition: all 0.8s ease;
        z-index: 0;
      }
      @media (prefers-reduced-motion: no-preference) {
        .vs-circle.correct::before {
          background: var(--success);
          animation: fillCircle 0.8s cubic-bezier(0.4, 0, 0.2, 1) forwards;
        }
        .vs-circle.incorrect::before {
          background: var(--error);
          animation: fillCircle 0.8s cubic-bezier(0.4, 0, 0.2, 1) forwards;
        }
      }
      @keyframes fillCircle {
        from {
          clip-path: circle(0% at center);
        }
        to {
          clip-path: circle(100% at center);
        }
      }
      .vs-circle-content {
        position: relative;
        z-index: 2;
        text-align: center;
        font-size: 52px;
        width: 100%;
        height: 100%;
        display: flex;
        align-items: center;
        justify-content: center;
      }
      .vs-text {
        opacity: 1;
        transition: opacity 0.3s ease;
        position: absolute;
      }
      .vs-text.hidden {
        opacity: 0;
        pointer-events: none;
      }
      .result-icon {
        font-size: 70px;
        opacity: 0;
        transition: opacity 0.3s ease;
        position: absolute;
        font-weight: 800;
      }
      .result-icon.show {
        opacity: 1;
      }
      .vs-circle.correct {
        border-color: var(--success);
        color: #fff;
        box-shadow: 0 0 40px rgba(16, 185, 129, 0.3);
      }
      .vs-circle.incorrect {
        border-color: var(--error);
        color: #fff;
        box-shadow: 0 0 40px rgba(239, 68, 68, 0.3);
      }
      .comparison-text {
        font-size: 17px;
        font-weight: 600;
        text-align: center;
        line-height: 1.6;
        max-width: 300px;
        letter-spacing: 0.5px;
      }
      .button-group {
        display: flex;
        flex-direction: column;
        gap: 16px;
        margin-top: 30px;
      }
      .btn {
        padding: 16px 40px;
        font-size: 16px;
        font-weight: 700;
        border: 2px solid;
        border-radius: 14px;
        cursor: pointer;
        text-transform: uppercase;
        letter-spacing: 1.5px;
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        background: transparent;
        color: #fff;
        min-width: 220px;
        min-height: 48px;
        position: relative;
        overflow: hidden;
      }
      .btn::before {
        content: "";
        position: absolute;
        inset: 0;
        background: currentColor;
        opacity: 0.1;
        z-index: 0;
        transition: opacity 0.3s ease;
      }
      .btn > * {
        position: relative;
        z-index: 1;
      }
      .btn-higher {
        border-color: var(--success);
        color: var(--success);
      }
      .btn-higher:hover:not(:disabled),
      .btn-higher:focus-visible {
        border-color: var(--success);
        box-shadow: 0 0 30px rgba(16, 185, 129, 0.4);
        transform: translateY(-4px);
        outline: 3px solid rgba(16, 185, 129, 0.3);
        outline-offset: 2px;
      }
      .btn-higher:hover:not(:disabled)::before {
        opacity: 0.2;
      }
      .btn-higher:active:not(:disabled) {
        transform: translateY(-2px) scale(0.98);
      }
      .btn-lower {
        border-color: var(--error);
        color: var(--error);
      }
      .btn-lower:hover:not(:disabled),
      .btn-lower:focus-visible {
        border-color: var(--error);
        box-shadow: 0 0 30px rgba(239, 68, 68, 0.4);
        transform: translateY(-4px);
        outline: 3px solid rgba(239, 68, 68, 0.3);
        outline-offset: 2px;
      }
      .btn-lower:hover:not(:disabled)::before {
        opacity: 0.2;
      }
      .btn-lower:active:not(:disabled) {
        transform: translateY(-2px) scale(0.98);
      }
      .btn:disabled {
        opacity: 0.4;
        cursor: not-allowed;
      }
      .milestone-badge {
        position: fixed;
        top: 100px;
        right: 30px;
        background: linear-gradient(135deg, #fbbf24, #f59e0b);
        color: #000;
        padding: 16px 24px;
        border-radius: 14px;
        font-weight: 800;
        font-size: 13px;
        text-transform: uppercase;
        letter-spacing: 1.5px;
        box-shadow: 0 10px 30px rgba(251, 191, 36, 0.4);
        z-index: 20;
        display: none;
      }
      @media (prefers-reduced-motion: no-preference) {
        .milestone-badge.show {
          display: block;
          animation: slideInRight 0.6s ease, pulse 2s ease-in-out 0.6s 2;
        }
      }
      .milestone-badge.show {
        display: block;
      }
      @keyframes slideInRight {
        from {
          opacity: 0;
          transform: translateX(100px);
        }
        to {
          opacity: 1;
          transform: translateX(0);
        }
      }
      .modal-subtitle {
        font-size: 15px;
        color: rgba(255, 255, 255, 0.7);
        margin-bottom: 28px;
      }
      .new-record {
        display: inline-block;
        background: linear-gradient(135deg, #fbbf24, #f59e0b);
        color: #000;
        padding: 12px 28px;
        border-radius: 50px;
        font-weight: 800;
        font-size: 12px;
        text-transform: uppercase;
        letter-spacing: 1.5px;
        margin-bottom: 24px;
      }
      @media (prefers-reduced-motion: no-preference) {
        .new-record {
          animation: badgeBounce 1s ease infinite alternate;
        }
      }
      @keyframes badgeBounce {
        from {
          transform: scale(1);
        }
        to {
          transform: scale(1.08);
        }
      }
      .new-record.hidden {
        display: none;
      }
      .final-score {
        font-size: 72px;
        font-weight: 900;
        margin: 20px 0;
        color: #fff;
        text-shadow: 0 5px 20px rgba(102, 126, 234, 0.4);
      }
      .stats-grid {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 16px;
        margin-bottom: 28px;
      }
      .stat-item {
        background: rgba(0, 0, 0, 0.3);
        border: 1px solid rgba(102, 126, 234, 0.2);
        border-radius: 16px;
        padding: 20px;
        backdrop-filter: blur(10px);
      }
      .stat-item-value {
        font-size: 32px;
        font-weight: 900;
        color: #667eea;
        margin-bottom: 8px;
      }
      .stat-item-label {
        font-size: 11px;
        text-transform: uppercase;
        letter-spacing: 1.5px;
        color: rgba(255, 255, 255, 0.6);
        font-weight: 600;
      }
      .loading {
        position: fixed;
        inset: 0;
        background: var(--bg);
        display: flex;
        align-items: center;
        justify-content: center;
        z-index: 9999;
        flex-direction: column;
        gap: 20px;
      }
      .loading.hidden {
        display: none;
      }
      .loader {
        width: 50px;
        height: 50px;
        border: 5px solid rgba(102, 126, 234, 0.2);
        border-top-color: #667eea;
        border-radius: 50%;
        animation: spin 1s linear infinite;
      }
      @keyframes spin {
        to {
          transform: rotate(360deg);
        }
      }
      .loading-text {
        font-size: 17px;
        color: rgba(255, 255, 255, 0.8);
        font-weight: 600;
      }
      .error-state {
        text-align: center;
        padding: 40px;
        color: rgba(255, 255, 255, 0.8);
      }
      .error-title {
        font-size: 24px;
        font-weight: 800;
        margin-bottom: 16px;
        color: var(--error);
      }
      .error-message {
        margin-bottom: 24px;
        line-height: 1.6;
      }
      .retry-btn {
        background: linear-gradient(135deg, #667eea, #f5576c);
        color: #fff;
        padding: 12px 32px;
        border: none;
        border-radius: 12px;
        font-size: 14px;
        font-weight: 700;
        cursor: pointer;
        text-transform: uppercase;
        letter-spacing: 1px;
        transition: all 0.3s ease;
        min-height: 48px;
      }
      .retry-btn:hover {
        transform: translateY(-3px);
        box-shadow: 0 10px 30px rgba(102, 126, 234, 0.4);
      }
      @media (max-width: 1200px) {
        .game-area {
          grid-template-columns: 1fr;
          gap: 40px;
        }
        .vs-circle {
          order: -1;
          margin-bottom: 20px;
        }
        .character-card {
          height: 550px;
        }
      }
      @media (max-width: 768px) {
        .header {
          padding: 15px 20px;
        }
        .logo {
          font-size: 24px;
        }
        .score-container {
          gap: 25px;
          width: 100%;
          justify-content: space-between;
        }
        .score-value {
          font-size: 28px;
        }
        .character-card {
          height: 480px;
        }
        .character-img {
          width: 220px;
          height: 280px;
        }
        .character-name {
          font-size: 22px;
        }
        .stat-number {
          font-size: 32px;
        }
        .vs-circle {
          width: 130px;
          height: 130px;
          font-size: 42px;
        }
        .modal-content,
        .tutorial-content {
          padding: 35px 25px;
        }
        .modal-title,
        .tutorial-title {
          font-size: 32px;
        }
        .final-score {
          font-size: 54px;
        }
        .stats-grid {
          grid-template-columns: 1fr;
          gap: 12px;
        }
        .sound-toggle {
          width: 45px;
          height: 45px;
          font-size: 20px;
          bottom: 20px;
          right: 20px;
        }
        .milestone-badge {
          top: 80px;
          right: 20px;
          font-size: 11px;
          padding: 12px 18px;
        }
        .tutorial-link {
          font-size: 11px;
          padding: 6px 12px;
        }
      }
      @media (max-width: 768px) and(orientation:landscape) {
        .character-card {
          height: 400px;
        }
        .character-img {
          width: 180px;
          height: 240px;
        }
      }
    </style>
  </head>
  <body>
    <div class="loading" id="loadingScreen">
      <div class="loader"></div>
      <div class="loading-text">Loading Characters...</div>
    </div>
    <div
      aria-live="polite"
      aria-atomic="true"
      class="sr-only"
      id="announcer"
    ></div>
    <div class="background">
      <div class="bg-blob blob-1"></div>
      <div class="bg-blob blob-2"></div>
    </div>
    <button
      class="sound-toggle"
      id="soundToggle"
      title="Toggle Sound"
      aria-label="Toggle sound effects"
    >
      üîä
    </button>
    <div
      class="milestone-badge"
      id="milestoneBadge"
      role="status"
      aria-live="polite"
    ></div>
    <div
      class="tutorial-modal"
      id="tutorialModal"
      role="dialog"
      aria-labelledby="tutorialTitle"
      aria-modal="true"
    >
      <div class="tutorial-content">
        <div style="font-size: 48px; margin-bottom: 16px">üéÆ</div>
        <h2 class="tutorial-title" id="tutorialTitle">How to Play</h2>
        <ul class="tutorial-steps">
          <li>You'll see two anime characters side by side</li>
          <li>The left character's favorite count is visible</li>
          <li>Guess if the right character has MORE or FEWER favorites</li>
          <li>Get it right to continue playing</li>
          <li>One wrong guess = Game Over</li>
          <li>Build your streak to reach milestones!</li>
        </ul>
        <div class="keyboard-hint">
          üí° <strong>Keyboard Shortcuts:</strong> Press ‚Üë or W for Higher, ‚Üì or
          S for Lower
        </div>
        <button class="tutorial-btn" id="startGameBtn">Start Game</button>
      </div>
    </div>
    <div class="header">
      <div class="logo">‚ö° Anime Battle</div>
      <div class="header-actions">
        <button
          class="tutorial-link"
          id="showTutorial"
          aria-label="Show tutorial"
        >
          üìñ Tutorial
        </button>
      </div>
      <div class="score-container">
        <div class="score-item">
          <div class="score-label">Current Score</div>
          <div class="score-value" id="score" aria-live="polite">0</div>
          <div class="streak-badge" id="streakBadge" aria-live="polite">
            üî• Streak: <span id="streakCount">0</span>
          </div>
        </div>
        <div class="score-item">
          <div class="score-label">High Score</div>
          <div class="score-value" id="highScore">0</div>
          <div class="streak-badge" style="opacity: 1; transform: scale(1)">
            üèÜ Max: <span id="maxStreak">0</span>
          </div>
        </div>
      </div>
    </div>
    <div class="container">
      <div class="game-area">
        <div class="character-card">
          <div class="card-bg"><img id="bgImgA" alt="" /></div>
          <div class="card-overlay"></div>
          <div class="card-content">
            <div class="character-img-wrapper">
              <div class="character-img">
                <img id="imgA" alt="" loading="lazy" />
              </div>
            </div>
            <div class="character-info">
              <div class="character-name" id="nameA"></div>
              <div class="character-anime" id="animeA"></div>
              <div class="stat-box">
                <div class="stat-label">Favorites</div>
                <div class="stat-number" id="favA"></div>
                <div class="comparison-info" id="compA"></div>
              </div>
            </div>
          </div>
        </div>
        <div
          style="
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 40px;
          "
        >
          <div class="vs-circle" id="vsCircle" aria-label="Versus">
            <div class="vs-circle-content">
              <div class="vs-text">VS</div>
              <div class="result-icon">‚úì</div>
            </div>
          </div>
          <div class="comparison-text" id="comparisonText">
            <span
              id="charBName"
              style="color: #667eea; font-weight: 800"
            ></span>
            <span style="color: rgba(255, 255, 255, 0.7)"> has </span>
            <span style="color: #10b981; font-weight: 800">MORE</span>
            <span style="color: rgba(255, 255, 255, 0.7)"> or </span>
            <span style="color: #ef4444; font-weight: 800">FEWER</span>
            <span style="color: rgba(255, 255, 255, 0.7)">
              Favorites than
            </span>
            <span
              id="charAName"
              style="color: #f5576c; font-weight: 800"
            ></span>
            <span style="color: rgba(255, 255, 255, 0.7)">?</span>
          </div>
          <div class="button-group">
            <button
              class="btn btn-higher"
              id="higherBtn"
              aria-label="Guess higher favorites"
            >
              <span>‚Üë Higher</span>
            </button>
            <button
              class="btn btn-lower"
              id="lowerBtn"
              aria-label="Guess lower favorites"
            >
              <span>‚Üì Lower</span>
            </button>
          </div>
        </div>
        <div class="character-card">
          <div class="card-bg"><img id="bgImgB" alt="" /></div>
          <div class="card-overlay"></div>
          <div class="card-content">
            <div class="character-img-wrapper">
              <div class="character-img">
                <img id="imgB" alt="" loading="lazy" />
              </div>
            </div>
            <div class="character-info">
              <div class="character-name" id="nameB"></div>
              <div class="character-anime" id="animeB"></div>
              <div class="stat-box">
                <div class="stat-label">Favorites</div>
                <div class="stat-number hidden" id="favB">?</div>
                <div class="comparison-info" id="compB"></div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div
      class="modal"
      id="gameOverModal"
      role="dialog"
      aria-labelledby="gameOverTitle"
      aria-modal="true"
    >
      <div class="modal-content">
        <div style="font-size: 72px; margin-bottom: 24px">üéÆ</div>
        <h2 class="modal-title" id="gameOverTitle">Game Over</h2>
        <p class="modal-subtitle">Amazing effort! Check your stats below...</p>
        <div class="new-record hidden" id="newRecord">
          üéâ NEW HIGH SCORE! üéâ
        </div>
        <div class="final-score" id="finalScore">0</div>
        <div class="stats-grid">
          <div class="stat-item">
            <div class="stat-item-value" id="modalHighScore">0</div>
            <div class="stat-item-label">Best Score</div>
          </div>
          <div class="stat-item">
            <div class="stat-item-value" id="modalAccuracy">0%</div>
            <div class="stat-item-label">Accuracy</div>
          </div>
          <div class="stat-item">
            <div class="stat-item-value" id="modalMaxStreak">0</div>
            <div class="stat-item-label">Max Streak</div>
          </div>
          <div class="stat-item">
            <div class="stat-item-value" id="modalTotalGuesses">0</div>
            <div class="stat-item-label">Total Guesses</div>
          </div>
        </div>
        <button class="btn-play-again" id="playAgainBtn">Play Again</button>
      </div>
    </div>
    <script>
      class Game {
        constructor() {
          this.chars = [];
          this.preloadQueue = [];
          this.recentlyUsed = [];
          this.charA = null;
          this.charB = null;
          this.score = 0;
          this.highScore = this.getLS("animeHighScore", 0);
          this.streak = 0;
          this.maxStreak = this.getLS("animeMaxStreak", 0);
          this.totalGuesses = 0;
          this.correctGuesses = 0;
          this.animating = !1;
          this.soundEnabled = !0;
          this.audioContext = null;
          this.milestones = [5, 10, 15, 20, 25, 30, 40, 50];
          this.milestonesReached = new Set();
          this.retryCount = 0;
          this.maxRetries = 3;
          this.init();
          this.loadData();
        }
        getLS(e, t) {
          try {
            const a = localStorage.getItem(e);
            return a ? parseInt(a) : t;
          } catch (e) {
            return console.warn("LocalStorage error:", e), t;
          }
        }
        setLS(e, t) {
          try {
            localStorage.setItem(e, t);
          } catch (e) {
            console.warn("LocalStorage error:", e);
          }
        }
        async loadData() {
          try {
            document.getElementById("loadingScreen").classList.remove("hidden");
            const e = await fetch("anime_characters.json");
            if (!e.ok) throw new Error("Failed to load characters");
            const t = await e.json();
            if (
              ((this.chars = this.shuffle(
                t.filter(
                  (e) =>
                    e && "number" == typeof e.favorites && !isNaN(e.favorites)
                )
              )),
              0 === this.chars.length)
            )
              throw new Error("No valid characters found");
            document.getElementById("loadingScreen").classList.add("hidden"),
              this.updateUI(),
              this.showTutorial();
          } catch (e) {
            console.error("Error:", e);
            this.showError(e.message);
          }
        }
        showError(e) {
          const t = document.getElementById("loadingScreen");
          t.innerHTML = `<div class="error-state"><div class="error-title">‚ö†Ô∏è Error Loading</div><div class="error-message">${e}<br><br>Please ensure anime_characters.json is in the same directory.</div><button class="retry-btn" onclick="location.reload()">Retry</button></div>`;
          t.classList.remove("hidden");
        }
        init() {
          this.els = {
            score: document.getElementById("score"),
            highScore: document.getElementById("highScore"),
            streakBadge: document.getElementById("streakBadge"),
            streakCount: document.getElementById("streakCount"),
            maxStreak: document.getElementById("maxStreak"),
            finalScore: document.getElementById("finalScore"),
            newRecord: document.getElementById("newRecord"),
            modal: document.getElementById("gameOverModal"),
            modalHighScore: document.getElementById("modalHighScore"),
            modalAccuracy: document.getElementById("modalAccuracy"),
            modalMaxStreak: document.getElementById("modalMaxStreak"),
            modalTotalGuesses: document.getElementById("modalTotalGuesses"),
            vsCircle: document.getElementById("vsCircle"),
            milestoneBadge: document.getElementById("milestoneBadge"),
            soundToggle: document.getElementById("soundToggle"),
            tutorialModal: document.getElementById("tutorialModal"),
            startGameBtn: document.getElementById("startGameBtn"),
            showTutorial: document.getElementById("showTutorial"),
            announcer: document.getElementById("announcer"),
            imgA: document.getElementById("imgA"),
            nameA: document.getElementById("nameA"),
            animeA: document.getElementById("animeA"),
            favA: document.getElementById("favA"),
            bgImgA: document.getElementById("bgImgA"),
            compA: document.getElementById("compA"),
            imgB: document.getElementById("imgB"),
            nameB: document.getElementById("nameB"),
            animeB: document.getElementById("animeB"),
            favB: document.getElementById("favB"),
            bgImgB: document.getElementById("bgImgB"),
            compB: document.getElementById("compB"),
            charAName: document.getElementById("charAName"),
            charBName: document.getElementById("charBName"),
            higherBtn: document.getElementById("higherBtn"),
            lowerBtn: document.getElementById("lowerBtn"),
            playAgainBtn: document.getElementById("playAgainBtn"),
          };
          this.els.higherBtn.addEventListener("click", () => this.guess(!0));
          this.els.lowerBtn.addEventListener("click", () => this.guess(!1));
          this.els.playAgainBtn.addEventListener("click", () => this.start());
          this.els.soundToggle.addEventListener("click", () =>
            this.toggleSound()
          );
          this.els.startGameBtn.addEventListener("click", () =>
            this.closeTutorial()
          );
          this.els.showTutorial.addEventListener("click", () =>
            this.openTutorial()
          );
          document.addEventListener("keydown", (e) => {
            ("ArrowUp" === e.key || "w" === e.key || "W" === e.key) &&
              this.guess(!0);
            ("ArrowDown" === e.key || "s" === e.key || "S" === e.key) &&
              this.guess(!1);
          });
        }
        showTutorial() {
          this.getLS("animeGameTutorialSeen", null)
            ? this.start()
            : (this.els.tutorialModal.classList.add("active"),
              this.setLS("animeGameTutorialSeen", "true"));
        }
        closeTutorial() {
          this.els.tutorialModal.classList.remove("active"), this.start();
        }
        openTutorial() {
          this.els.tutorialModal.classList.add("active");
        }
        start() {
          (this.score = 0),
            (this.streak = 0),
            (this.totalGuesses = 0),
            (this.correctGuesses = 0),
            (this.recentlyUsed = []),
            this.milestonesReached.clear(),
            (this.els.score.textContent = this.score),
            this.els.streakBadge.classList.remove("visible"),
            this.els.modal.classList.remove("active"),
            this.els.vsCircle.classList.remove("correct", "incorrect"),
            (this.charA = this.getRandomUnused()),
            (this.charB = this.getRandomUnused());
          for (; this.charA === this.charB; )
            this.charB = this.getRandomUnused();
          this.render(), this.enable(), this.preloadNext();
        }
        getRandomUnused() {
          const e = this.chars.filter((e) => !this.recentlyUsed.includes(e));
          if (0 === e.length)
            return (
              (this.recentlyUsed = []),
              this.chars[Math.floor(Math.random() * this.chars.length)]
            );
          const t = e[Math.floor(Math.random() * e.length)];
          return (
            this.recentlyUsed.push(t),
            this.recentlyUsed.length > 20 && this.recentlyUsed.shift(),
            t
          );
        }
        preloadNext() {
          const e = [this.getRandomUnused(), this.getRandomUnused()];
          e.forEach((e) => {
            const t = new Image();
            t.src = e.image;
          });
        }
        render() {
          (this.els.imgA.src = this.charA.image),
            (this.els.imgA.alt = `Character portrait of ${this.charA.name}`),
            (this.els.nameA.textContent = this.charA.name),
            (this.els.animeA.textContent = this.charA.anime || "Unknown Anime"),
            (this.els.favA.textContent = this.charA.favorites.toLocaleString()),
            (this.els.bgImgA.src = this.charA.image),
            this.els.compA.classList.remove("visible"),
            (this.els.imgB.src = this.charB.image),
            (this.els.imgB.alt = `Character portrait of ${this.charB.name}`),
            (this.els.nameB.textContent = this.charB.name),
            (this.els.animeB.textContent = this.charB.anime || "Unknown Anime"),
            (this.els.favB.textContent = "?"),
            (this.els.favB.className = "stat-number hidden"),
            (this.els.bgImgB.src = this.charB.image),
            this.els.compB.classList.remove("visible"),
            (this.els.charAName.textContent = this.charA.name),
            (this.els.charBName.textContent = this.charB.name);
        }
        async guess(e) {
          if (this.animating) return;
          (this.animating = !0), this.disable(), this.totalGuesses++;
          const t = e
            ? this.charB.favorites >= this.charA.favorites
            : this.charB.favorites < this.charA.favorites;
          t && this.correctGuesses++,
            (this.els.favB.textContent = this.charB.favorites.toLocaleString()),
            (this.els.favB.className = `stat-number ${
              t ? "correct" : "incorrect"
            }`);
          const a = this.els.vsCircle.querySelector(".vs-text"),
            s = this.els.vsCircle.querySelector(".result-icon");
          this.els.vsCircle.classList.add(t ? "correct" : "incorrect"),
            a.classList.add("hidden"),
            s.classList.add("show"),
            (s.textContent = t ? "‚úì" : "‚úó"),
            this.announce(
              t
                ? `Correct! ${
                    this.charB.name
                  } has ${this.charB.favorites.toLocaleString()} favorites`
                : `Incorrect. ${
                    this.charB.name
                  } has ${this.charB.favorites.toLocaleString()} favorites`
            );
          const i = Math.abs(this.charA.favorites - this.charB.favorites),
            r = (
              (i / Math.max(this.charA.favorites, this.charB.favorites)) *
              100
            ).toFixed(1);
          (this.els.compB.textContent = `${i.toLocaleString()} difference (${r}%)`),
            this.els.compB.classList.add("visible"),
            this.playSound(t ? "correct" : "incorrect"),
            await this.sleep(2500),
            t
              ? (this.score++,
                this.streak++,
                (this.els.score.textContent = this.score),
                this.updateStreakUI(),
                this.checkMilestones(),
                await this.sleep(500),
                this.els.vsCircle.classList.remove("correct", "incorrect"),
                a.classList.remove("hidden"),
                s.classList.remove("show"),
                (this.charA = this.charB),
                (this.charB = this.getRandomUnused()),
                this.render(),
                this.enable(),
                this.preloadNext(),
                (this.animating = !1))
              : (await this.sleep(500), this.end());
        }
        checkMilestones() {
          for (let e of this.milestones)
            this.score === e &&
              !this.milestonesReached.has(e) &&
              (this.milestonesReached.add(e), this.showMilestone(e));
        }
        showMilestone(e) {
          (this.els.milestoneBadge.textContent = `üéØ ${e} POINTS! üéØ`),
            this.els.milestoneBadge.classList.add("show"),
            this.playSound("milestone"),
            this.announce(`Milestone reached: ${e} points!`),
            setTimeout(() => {
              this.els.milestoneBadge.classList.remove("show");
            }, 3e3);
        }
        updateStreakUI() {
          this.streak > 0 &&
            (this.els.streakBadge.classList.add("visible"),
            (this.els.streakCount.textContent = this.streak));
        }
        end() {
          this.streak > this.maxStreak &&
            ((this.maxStreak = this.streak),
            this.setLS("animeMaxStreak", this.maxStreak),
            (this.els.maxStreak.textContent = this.maxStreak));
          const e =
            this.totalGuesses > 0
              ? Math.round((this.correctGuesses / this.totalGuesses) * 100)
              : 0;
          (this.els.finalScore.textContent = this.score),
            (this.els.modalHighScore.textContent = Math.max(
              this.score,
              this.highScore
            )),
            (this.els.modalAccuracy.textContent = e + "%"),
            (this.els.modalMaxStreak.textContent = Math.max(
              this.streak,
              this.maxStreak
            )),
            (this.els.modalTotalGuesses.textContent = this.totalGuesses),
            this.score > this.highScore
              ? ((this.highScore = this.score),
                (this.els.highScore.textContent = this.highScore),
                this.setLS("animeHighScore", this.highScore),
                this.els.newRecord.classList.remove("hidden"),
                this.playSound("newRecord"),
                this.announce(`New high score: ${this.score} points!`))
              : this.els.newRecord.classList.add("hidden"),
            this.els.modal.classList.add("active"),
            (this.animating = !1);
        }
        updateUI() {
          (this.els.score.textContent = this.score),
            (this.els.highScore.textContent = this.highScore),
            (this.els.maxStreak.textContent = this.maxStreak);
        }
        toggleSound() {
          (this.soundEnabled = !this.soundEnabled),
            (this.els.soundToggle.textContent = this.soundEnabled
              ? "üîä"
              : "üîá"),
            this.els.soundToggle.setAttribute(
              "aria-label",
              this.soundEnabled ? "Mute sound effects" : "Unmute sound effects"
            );
        }
        playSound(e) {
          if (!this.soundEnabled) return;
          this.audioContext ||
            (this.audioContext = new (window.AudioContext ||
              window.webkitAudioContext)());
          const t = this.audioContext.currentTime;
          if ("correct" === e) {
            const e = this.audioContext.createOscillator(),
              a = this.audioContext.createOscillator(),
              s = this.audioContext.createGain();
            (e.frequency.value = 523.25),
              (a.frequency.value = 659.25),
              s.gain.setValueAtTime(0.3, t),
              s.gain.exponentialRampToValueAtTime(0.01, t + 0.2),
              e.connect(s),
              a.connect(s),
              s.connect(this.audioContext.destination),
              e.start(t),
              a.start(t),
              e.stop(t + 0.2),
              a.stop(t + 0.2);
          } else if ("incorrect" === e) {
            const e = this.audioContext.createOscillator(),
              a = this.audioContext.createGain();
            e.frequency.setValueAtTime(300, t),
              e.frequency.exponentialRampToValueAtTime(100, t + 0.3),
              a.gain.setValueAtTime(0.3, t),
              a.gain.exponentialRampToValueAtTime(0.01, t + 0.3),
              e.connect(a),
              a.connect(this.audioContext.destination),
              e.start(t),
              e.stop(t + 0.3);
          } else if ("milestone" === e)
            [523.25, 659.25, 783.99].forEach((e, a) => {
              const s = this.audioContext.createOscillator(),
                i = this.audioContext.createGain();
              (s.frequency.value = e),
                i.gain.setValueAtTime(0.2, t + 0.15 * a),
                i.gain.exponentialRampToValueAtTime(0.01, t + 0.15 * a + 0.15),
                s.connect(i),
                i.connect(this.audioContext.destination),
                s.start(t + 0.15 * a),
                s.stop(t + 0.15 * a + 0.15);
            });
          else if ("newRecord" === e)
            [659.25, 783.99, 987.77].forEach((e, a) => {
              const s = this.audioContext.createOscillator(),
                i = this.audioContext.createGain();
              (s.frequency.value = e),
                i.gain.setValueAtTime(0.2, t + 0.1 * a),
                i.gain.exponentialRampToValueAtTime(0.01, t + 0.1 * a + 0.2),
                s.connect(i),
                i.connect(this.audioContext.destination),
                s.start(t + 0.1 * a),
                s.stop(t + 0.1 * a + 0.2);
            });
        }
        announce(e) {
          this.els.announcer && (this.els.announcer.textContent = e);
        }
        shuffle(e) {
          const t = [...e];
          for (let e = t.length - 1; e > 0; e--) {
            const a = Math.floor(Math.random() * (e + 1));
            [t[e], t[a]] = [t[a], t[e]];
          }
          return t;
        }
        enable() {
          (this.els.higherBtn.disabled = !1), (this.els.lowerBtn.disabled = !1);
        }
        disable() {
          (this.els.higherBtn.disabled = !0), (this.els.lowerBtn.disabled = !0);
        }
        sleep(e) {
          return new Promise((t) => setTimeout(t, e));
        }
      }
      new Game();
    </script>
  </body>
</html>
